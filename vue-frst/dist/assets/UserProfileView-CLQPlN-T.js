import{d as re,Y as I,a9 as oe,c as A,u as a,z as He,w as d,y as o,G as n,I as Pe,a as i,K as Je,J as N,aC as Ge,L as Z,t as _,a2 as q,e as F,q as V,aD as Ke,aE as Ye,U as Ze,Q as O,aF as Xe,h as S,aG as Qe,ad as el,D as r,_ as ie,R as ll,r as u,Z as se,ag as Ce,b as tl,aH as sl,ak as al,f as Ue,ai as ue,T as ae,A as m,a4 as $e,a8 as ol,N as rl,ah as be,aI as B,o as il,H as W,S as Y,M as nl,ar as ul,aj as dl,C as cl}from"./index-B8L1PXQk.js";const vl={class:"post-image-container"},fl={class:"image-slot error"},gl={key:1,class:"image-slot placeholder"},pl={class:"post-details"},wl={class:"post-header"},ml={class:"author-name"},yl={class:"post-date"},hl={class:"post-content"},Ul={class:"post-title"},bl={class:"content-preview"},kl=re({__name:"PostCard",props:{post:{type:Object,required:!0},isAuthor:{type:Boolean,default:!1}},emits:["card-click","edit","delete"],setup(p,{emit:E}){const U=p,y=E,f=()=>{console.log(`[PostCard] handleCardClick triggered for post ID: ${U.post.id}`),y("card-click",U.post.id)},s=I(()=>oe(U.post.imageUrl)),$=I(()=>{var g;return oe((g=U.post.author)==null?void 0:g.avatarUrl)}),b=I(()=>{var v;if(!((v=U.post)!=null&&v.createdAt))return"";const g=new Date(U.post.createdAt),P=Math.abs(new Date().getTime()-g.getTime()),h=Math.ceil(P/(1e3*60*60*24));return h<1?"今天":h<7?`${h}天前`:g.toLocaleDateString("zh-CN",{month:"short",day:"numeric"})});return(g,c)=>(r(),A(a(He),{class:"post-card",shadow:"hover","body-style":{padding:"0px"},onClick:f},{default:d(()=>{var P;return[o("div",vl,[p.post.imageUrl?(r(),A(a(Pe),{key:0,src:s.value,fit:"cover",class:"post-image",lazy:""},{placeholder:d(()=>c[7]||(c[7]=[o("div",{class:"image-slot loading"},"加载中...",-1)])),error:d(()=>[o("div",fl,[i(a(N),null,{default:d(()=>[i(a(Je))]),_:1})])]),_:1},8,["src"])):(r(),n("div",gl,[i(a(N),null,{default:d(()=>[i(a(Ge))]),_:1})]))]),o("div",pl,[o("div",wl,[i(a(Z),{size:30,src:$.value},null,8,["src"]),o("span",ml,_(((P=p.post.author)==null?void 0:P.name)||"匿名用户"),1),o("span",yl,_(b.value),1)]),o("div",hl,[o("p",Ul,_(p.post.title||"无标题"),1),o("p",bl,_(p.post.content?p.post.content.substring(0,80)+"...":"无内容"),1)]),o("div",{class:"post-footer",onClick:c[6]||(c[6]=q(()=>{},["stop"]))},[o("span",{class:"stat-item",onClick:c[0]||(c[0]=q(()=>{},["stop"]))},[i(a(N),null,{default:d(()=>[i(a(Ke))]),_:1}),V(" "+_(p.post.likesCount||0),1)]),o("span",{class:"stat-item",onClick:c[1]||(c[1]=q(()=>{},["stop"]))},[i(a(N),null,{default:d(()=>[i(a(Ye))]),_:1}),V(" "+_(p.post.commentsCount||0),1)]),o("span",{class:"stat-item",onClick:c[2]||(c[2]=q(()=>{},["stop"]))},[i(a(N),null,{default:d(()=>[i(a(Ze))]),_:1}),V(" "+_(p.post.favoritesCount||0),1)]),c[10]||(c[10]=o("span",{class:"spacer"},null,-1)),p.isAuthor?(r(),n(O,{key:0},[i(a(S),{link:"",type:"primary",size:"small",onClick:c[3]||(c[3]=q(h=>y("edit",p.post.id),["stop"])),class:"action-button"},{default:d(()=>[i(a(N),null,{default:d(()=>[i(a(Xe))]),_:1}),c[8]||(c[8]=V(" 编辑 "))]),_:1}),i(a(S),{link:"",type:"danger",size:"small",onClick:c[4]||(c[4]=q(h=>y("delete",p.post.id),["stop"])),class:"action-button"},{default:d(()=>[i(a(N),null,{default:d(()=>[i(a(Qe))]),_:1}),c[9]||(c[9]=V(" 删除 "))]),_:1})],64)):F("",!0),i(a(N),{class:"more-icon",onClick:c[5]||(c[5]=q(()=>{},["stop"]))},{default:d(()=>[i(a(el))]),_:1})])])]}),_:1}))}}),ke=ie(kl,[["__scopeId","data-v-810f2900"]]),_l={class:"user-list-item"},Pl={class:"user-details"},Cl={class:"user-name"},$l={key:0,class:"user-bio"},Fl=re({__name:"UserListItem",props:{user:{type:Object,required:!0},showFollowButton:{type:Boolean,default:!1},isFollowing:{type:Boolean,default:!1},isLoading:{type:Boolean,default:!1}},emits:["toggle-follow"],setup(p,{emit:E}){const U=p,y=I(()=>oe(U.user.avatarUrl));return(f,s)=>(r(),n("div",_l,[i(a(ll),{to:{name:"UserProfile",params:{userId:p.user.id}},class:"user-info-link"},{default:d(()=>[i(a(Z),{size:40,src:y.value,class:"user-avatar"},null,8,["src"]),o("div",Pl,[o("span",Cl,_(p.user.name||p.user.username||"用户"+p.user.id),1),p.user.bio?(r(),n("span",$l,_(p.user.bio),1)):F("",!0)])]),_:1},8,["to"]),s[0]||(s[0]=o("div",{class:"user-actions"},null,-1))]))}}),_e=ie(Fl,[["__scopeId","data-v-a31fadd7"]]),Dl={class:"dialog-footer"},Vl=re({__name:"PostEditModal",props:{visible:{type:Boolean,default:!1},postData:{type:Object,default:null}},emits:["update:visible","post-updated"],setup(p,{emit:E}){const U=p,y=E,f=u(),s=u(!1),$=u(null),b=u({title:"",content:""}),g=u({title:[{required:!0,message:"请输入标题",trigger:"blur"}],content:[{required:!0,message:"请输入内容",trigger:"blur"}]});se(()=>U.visible,h=>{h&&U.postData&&($.value={...U.postData},b.value.title=U.postData.title||"",b.value.content=U.postData.content||"",$e(()=>{var v;(v=f.value)==null||v.clearValidate()}))});const c=()=>{var h;$.value=null,b.value.title="",b.value.content="",(h=f.value)==null||h.resetFields()},P=async()=>{var h,v;if(!(!f.value||!$.value))try{if(await f.value.validate()){s.value=!0;const z=$.value.id,R={title:b.value.title,content:b.value.content};try{const T=await ae.updatePost(z,R);m.success("帖子更新成功"),y("post-updated",T),y("update:visible",!1)}catch(T){console.error("Failed to update post:",T),m.error(((v=(h=T.response)==null?void 0:h.data)==null?void 0:v.message)||"更新帖子失败")}finally{s.value=!1}}else return console.log("Form validation failed"),!1}catch(D){console.log("Form validation error (catch):",D)}};return(h,v)=>(r(),A(a(Ce),{"model-value":p.visible,title:"编辑帖子",width:"600px","onUpdate:modelValue":v[3]||(v[3]=D=>h.$emit("update:visible",D)),onClosed:c,"close-on-click-modal":!1},{footer:d(()=>[o("span",Dl,[i(a(S),{onClick:v[2]||(v[2]=D=>h.$emit("update:visible",!1))},{default:d(()=>v[4]||(v[4]=[V("取消")])),_:1}),i(a(S),{type:"primary",onClick:P,loading:s.value},{default:d(()=>v[5]||(v[5]=[V(" 保存 ")])),_:1},8,["loading"])])]),default:d(()=>[$.value?tl((r(),A(a(al),{key:0,ref_key:"editFormRef",ref:f,model:b.value,rules:g.value,"label-width":"80px"},{default:d(()=>[i(a(ue),{label:"标题",prop:"title"},{default:d(()=>[i(a(Ue),{modelValue:b.value.title,"onUpdate:modelValue":v[0]||(v[0]=D=>b.value.title=D),placeholder:"请输入标题"},null,8,["modelValue"])]),_:1}),i(a(ue),{label:"内容",prop:"content"},{default:d(()=>[i(a(Ue),{modelValue:b.value.content,"onUpdate:modelValue":v[1]||(v[1]=D=>b.value.content=D),type:"textarea",rows:5,placeholder:"请输入内容"},null,8,["modelValue"])]),_:1}),$.value.imageUrl?(r(),A(a(ue),{key:0,label:"图片"},{default:d(()=>[i(a(Pe),{style:{width:"100px",height:"100px"},src:a(oe)($.value.imageUrl),fit:"cover"},null,8,["src"])]),_:1})):F("",!0)]),_:1},8,["model","rules"])),[[a(sl),s.value]]):F("",!0)]),_:1},8,["model-value"]))}}),Al=ie(Vl,[["__scopeId","data-v-62945969"]]),Ll={key:0,class:"loading-state"},Bl={key:1,class:"error-state"},Il={key:2,class:"user-profile-view"},El={class:"profile-banner"},Tl={key:0,class:"edit-icon-overlay"},xl={class:"profile-info"},Nl={class:"user-bio"},Sl={class:"user-stats-tabs"},Ml={class:"tab-count"},zl={class:"tab-count"},Rl={class:"tab-count"},ql={class:"tab-count"},Wl={class:"profile-content"},Ol={key:0},jl={key:0,class:"tab-placeholder"},Hl={key:1,class:"tab-placeholder"},Jl={key:2,class:"post-list"},Gl={key:0,class:"loading-more"},Kl={key:1},Yl={key:0,class:"loading-placeholder"},Zl={key:1,class:"empty-placeholder"},Xl={key:2,class:"post-list"},Ql={key:0,class:"loading-more"},et={key:2},lt={key:0,class:"loading-placeholder"},tt={key:1,class:"empty-placeholder"},st={key:2,class:"user-list"},at={key:0,class:"loading-more"},ot={key:3},rt={key:0,class:"loading-placeholder"},it={key:1,class:"empty-placeholder"},nt={key:2,class:"user-list"},ut={key:0,class:"loading-more"},dt={key:3,class:"not-found"},ct={class:"dialog-content"},vt={class:"preview-section"},ft={class:"setting-item avatar-upload-dialog"},gt={class:"setting-item default-avatars"},pt={class:"avatar-options"},wt={class:"dialog-footer"},mt=re({__name:"UserProfileView",setup(p){const E=nl(),U=ol(),y=I(()=>U.params.userId),f=rl(),s=u(null),$=u(!0),b=u(null),g=u("posts"),c=u(!1),P=u([]),h=u(!1),v=u(0),D=u(0),z=u([]),R=u(!1),T=u(0),de=u(0),j=u(!1),x=u(null),X=u([]),H=u([]),J=u([]),G=u(!1),K=u(!1),Q=u(0),ee=u(0),ce=u(0),ve=u(0),le=u({}),ne=u(!1),fe=u(null),L=I(()=>{var e;return f.isLoggedIn&&((e=f.currentUser)==null?void 0:e.id)===Number(y.value)}),ge=I(()=>f.isLoggedIn&&f.currentUser&&f.currentUser.id!==Number(y.value)),Fe=I(()=>{var w;const e=(w=s.value)==null?void 0:w.avatarUrl;let l;if(e&&(e.startsWith("http://")||e.startsWith("https://")))l=e;else{const k=(be.defaults.baseURL||"").replace(/\/api\/?$/,""),M=e||"/avatars/defaults/default_avatar.png",je=M.startsWith("/")?M:"/"+M;l=`${k}${je}`}const t=`?t=${Date.now()}`;return l.includes("?")?`${l}&${t.substring(1)}`:`${l}${t}`}),De=I(()=>B.getUploadAvatarUrl()),Ve=I(()=>({Authorization:`Bearer ${f.token}`})),te=e=>{["posts","favorites","following","followers"].includes(e)&&(g.value=e,E.replace({query:{...U.query,tab:e}}))},pe=e=>{console.log(`[UserProfileView] goToPostDetail triggered with postId: ${e}`),e?(console.log(`[UserProfileView] Preparing to call router.push in nextTick for id: ${e}`),$e(()=>{try{console.log(`[UserProfileView] Executing router.push inside nextTick for PostDetail with id: ${e}`),E.push({name:"PostDetail",params:{id:e}})}catch(l){console.error("[UserProfileView] Error during router.push:",l)}})):console.warn("[UserProfileView] goToPostDetail called with invalid postId:",e)},Ae=e=>{console.log(`[UserProfileView] handleEditPost called for ID: ${e}`);const l=P.value.find(t=>t.id===e);l?(fe.value=l,ne.value=!0):(console.warn(`[UserProfileView] Post with ID ${e} not found for editing.`),m.error("找不到要编辑的帖子"))},Le=async()=>{if(!s.value||!ge.value)return;c.value=!0;const e=Number(y.value);try{s.value.isFollowing?(await B.unfollowUser(e),s.value&&(s.value.isFollowing=!1,s.value.followerCount--),m.success("已取消关注")):(await B.followUser(e),s.value&&(s.value.isFollowing=!0,s.value.followerCount++),m.success("关注成功"))}catch(l){console.error("Follow/Unfollow failed:",l),m.error("操作失败")}finally{c.value=!1}},we=async()=>{try{console.log("[UserProfileView] Calling UserService.getDefaultAvatars...");const e=await B.getDefaultAvatars();console.log("[UserProfileView] Raw response from UserService.getDefaultAvatars():",JSON.stringify(e,null,2)),X.value=e.avatarUrls,console.log("[UserProfileView] Assigned preset avatars to ref:",X.value)}catch(e){console.error("[UserProfileView] Failed to fetch preset avatars:",e)}},me=e=>{let l;if(e&&(e.startsWith("http://")||e.startsWith("https://")))l=e;else{const C=(be.defaults.baseURL||"").replace(/\/api\/?$/,""),k=e||"/avatars/defaults/default_avatar.png",M=k.startsWith("/")?k:"/"+k;l=`${C}${M}`}const t=`?t=${Date.now()}`;return l.includes("?")?`${l}&${t.substring(1)}`:`${l}${t}`},Be=()=>{var e;L.value&&(x.value=((e=f.currentUser)==null?void 0:e.avatarUrl)||null,X.value.length===0&&we(),j.value=!0)},Ie=(e,l)=>{console.log("[UserProfileView] Avatar Upload Success Response:",e),e&&typeof e.avatarUrl=="string"?(x.value=e.avatarUrl,m.success("头像上传成功! 请点击保存以应用更改。")):(console.error("[UserProfileView] Invalid response from avatar upload:",e),m.error((e==null?void 0:e.message)||"头像上传失败，响应数据无效"))},Ee=e=>{const l=e.type.startsWith("image/"),t=e.size/1024/1024<5;return l||m.error("只能上传图片文件!"),t||m.error("图片大小不能超过 5MB!"),l&&t},Te=async()=>{var t,w,C;const e=((t=f.currentUser)==null?void 0:t.avatarUrl)||null,l=x.value===void 0?null:x.value;if(l===e){j.value=!1;return}console.log("[UserProfileView] Saving avatar selection. New URL to save:",l);try{const k=await B.updateMyProfile({avatarUrl:l});if(console.log("[UserProfileView] Received user data after update:",JSON.stringify(k==null?void 0:k.user,null,2)),k&&k.user)f.setUser(k.user),L.value&&s.value&&(console.log("[UserProfileView] Updating local userData.avatarUrl for sync."),s.value.avatarUrl=k.user.avatarUrl===void 0?null:k.user.avatarUrl),m.success("头像更新成功!"),j.value=!1;else throw new Error("Invalid response after updating profile")}catch(k){console.error("Failed to update avatar:",k),m.error(((C=(w=k.response)==null?void 0:w.data)==null?void 0:C.message)||k.message||"头像更新失败")}},ye=async e=>{if(!f.isLoggedIn){m.warning("请先登录"),E.push("/login");return}le.value[e]=!0;try{const t=(g.value==="following"?H.value:J.value).find(C=>C.id===e);if(!t)return;t.isFollowing?(await B.unfollowUser(e),t.isFollowing=!1,s.value&&s.value.id===e&&(s.value.isFollowing=!1,s.value.followerCount=Math.max(0,(s.value.followerCount??0)-1)),L.value&&s.value&&(s.value.followingCount=Math.max(0,(s.value.followingCount??0)-1)),m.success("已取消关注")):(await B.followUser(e),t.isFollowing=!0,s.value&&s.value.id===e&&(s.value.isFollowing=!0,s.value.followerCount=(s.value.followerCount??0)+1),L.value&&s.value&&(s.value.followingCount=(s.value.followingCount??0)+1),m.success("关注成功"))}catch(l){console.error(`Toggle follow failed for user ${e}:`,l),m.error("操作失败")}finally{le.value[e]=!1}},xe=()=>{P.value=[],v.value=0,D.value=0,z.value=[],T.value=0,de.value=0,H.value=[],Q.value=0,ce.value=0,J.value=[],ee.value=0,ve.value=0},Ne=async(e=1,l=!1)=>{if(y.value){h.value=!0;try{const t=await ae.getPostsByUserId(Number(y.value),e,9);l?P.value.push(...t.posts):P.value=t.posts,v.value=t.currentPage,D.value=t.totalPages}catch(t){console.error("Failed to fetch user posts:",t),m.error("加载帖子列表失败")}finally{h.value=!1}}},Se=async(e=1,l=!1)=>{if(y.value){R.value=!0;try{const t=await ae.getFavoritedPosts(Number(y.value),e,9);l?z.value.push(...t.posts):z.value=t.posts,T.value=t.currentPage,de.value=t.totalPages}catch(t){console.error("Failed to fetch user favorites:",t),m.error("加载收藏列表失败")}finally{R.value=!1}}},Me=async(e=1,l=!1)=>{if(y.value){G.value=!0;try{const t=await B.getFollowing(Number(y.value),e,15);l?H.value.push(...t.following||[]):H.value=t.following||[],Q.value=t.currentPage,ce.value=t.totalPages}catch(t){console.error("Failed to fetch following list:",t),m.error("加载关注列表失败")}finally{G.value=!1}}},ze=async(e=1,l=!1)=>{if(y.value){K.value=!0;try{const t=await B.getFollowers(Number(y.value),e,15);l?J.value.push(...t.followers||[]):J.value=t.followers||[],ee.value=t.currentPage,ve.value=t.totalPages}catch(t){console.error("Failed to fetch followers list:",t),m.error("加载粉丝列表失败")}finally{K.value=!1}}},he=e=>{const l=Number(y.value);if(isNaN(l)){console.error("[UserProfileView] Invalid user ID for loading content");return}switch(console.log(`[UserProfileView] Loading data for tab: ${e}`),e){case"posts":Ne(1);break;case"favorites":Se(1);break;case"following":Me(1);break;case"followers":ze(1);break}},Re=async e=>{var l,t,w;$.value=!0,b.value=null,s.value=null;try{console.log(`[UserProfileView] Fetching profile for user ID: ${e}`),s.value=await B.getUserProfile(e),console.log("[UserProfileView] User profile data fetched:",s.value),xe();const C=U.query.tab,M=["posts","favorites","following","followers"].includes(C)?C:"posts";M!==g.value?g.value=M:he(g.value)}catch(C){console.error(`[UserProfileView] Error fetching profile for user ${e}:`,C),b.value=((l=C.response)==null?void 0:l.status)===404?"用户不存在。":((w=(t=C.response)==null?void 0:t.data)==null?void 0:w.message)||"加载用户信息时出错"}finally{$.value=!1}};se(y,e=>{if(e){const l=Number(e);isNaN(l)?(console.error(`[UserProfileView] Invalid user ID detected in route: ${e}`),b.value="无效的用户ID",$.value=!1):Re(l)}},{immediate:!0}),se(g,(e,l)=>{e&&e!==l&&(he(e),E.replace({query:{...U.query,tab:e}}))}),se(()=>U.query.tab,e=>{typeof e=="string"&&["posts","favorites","following","followers"].includes(e)&&e!==g.value&&(g.value=e)});const qe=e=>{var C;if(!e||f.currentUser===null)return!1;const l=Number(e.authorId),t=Number((C=f.currentUser)==null?void 0:C.id);return L.value&&!isNaN(l)&&!isNaN(t)&&l===t},We=async e=>{var l,t;console.log(`[UserProfileView] handleDeletePost called for ID: ${e}`);try{await cl.confirm("确定要永久删除这篇帖子吗？此操作无法撤销。","确认删除",{confirmButtonText:"确认删除",cancelButtonText:"取消",type:"warning"});try{await ae.deletePost(e),P.value=P.value.filter(w=>w.id!==e),s.value&&typeof s.value.postCount=="number"&&(s.value.postCount=Math.max(0,s.value.postCount-1)),m.success("帖子删除成功")}catch(w){console.error(`Failed to delete post ${e}:`,w),m.error(((t=(l=w.response)==null?void 0:l.data)==null?void 0:t.message)||"删除帖子失败")}}catch{m.info("已取消删除")}},Oe=e=>{console.log("[UserProfileView] handlePostUpdated called with:",e);const l=P.value.findIndex(t=>t.id===e.id);l!==-1?(P.value.splice(l,1,e),m.success("帖子列表已更新")):console.warn("[UserProfileView] Updated post not found in local list, list might be out of sync.")};return il(()=>{we()}),(e,l)=>(r(),n(O,null,[$.value?(r(),n("div",Ll,"加载中...")):b.value?(r(),n("div",Bl,_(b.value),1)):s.value?(r(),n("div",Il,[o("div",El,[o("div",{class:W(["profile-avatar-container",{clickable:L.value}]),onClick:l[0]||(l[0]=t=>L.value?Be():null)},[i(a(Z),{size:100,src:Fe.value,class:"profile-avatar"},null,8,["src"]),L.value?(r(),n("div",Tl,[i(a(N),null,{default:d(()=>[i(a(ul))]),_:1})])):F("",!0)],2)]),o("div",xl,[o("h2",null,_(s.value.name||s.value.username),1),o("p",Nl,_(s.value.bio||"这个人很懒，什么都没留下~"),1),o("div",Sl,[o("div",{class:W(["tab-item",{active:g.value==="posts"}]),onClick:l[1]||(l[1]=t=>te("posts"))},[o("div",Ml,_(s.value.postCount??0),1),l[9]||(l[9]=o("div",{class:"tab-label"},"动态",-1))],2),o("div",{class:W(["tab-item",{active:g.value==="followers"}]),onClick:l[2]||(l[2]=t=>te("followers"))},[o("div",zl,_(s.value.followerCount??0),1),l[10]||(l[10]=o("div",{class:"tab-label"},"粉丝",-1))],2),o("div",{class:W(["tab-item",{active:g.value==="following"}]),onClick:l[3]||(l[3]=t=>te("following"))},[o("div",Rl,_(s.value.followingCount??0),1),l[11]||(l[11]=o("div",{class:"tab-label"},"关注",-1))],2),o("div",{class:W(["tab-item",{active:g.value==="favorites"}]),onClick:l[4]||(l[4]=t=>te("favorites"))},[o("div",ql,_(s.value.favoritesCount??0),1),l[12]||(l[12]=o("div",{class:"tab-label"},"收藏",-1))],2)]),ge.value?(r(),A(a(S),{key:0,type:s.value.isFollowing?"default":"primary",onClick:Le,loading:c.value},{default:d(()=>[V(_(s.value.isFollowing?"已关注":"关注"),1)]),_:1},8,["type","loading"])):F("",!0)]),o("div",Wl,[g.value==="posts"?(r(),n("div",Ol,[h.value&&v.value===1?(r(),n("div",jl," 正在加载帖子... ")):!h.value&&P.value.length===0?(r(),n("div",Hl," 该用户还没有发布任何动态哦~ ")):(r(),n("div",Jl,[(r(!0),n(O,null,Y(P.value,t=>(r(),A(ke,{key:t.id,post:t,onCardClick:pe,"is-author":qe(t),onDelete:We,onEdit:Ae,class:"profile-post-card"},null,8,["post","is-author"]))),128)),h.value&&v.value>1?(r(),n("div",Gl,"加载更多...")):F("",!0)]))])):F("",!0),g.value==="favorites"?(r(),n("div",Kl,[R.value&&T.value===1?(r(),n("div",Yl," 正在加载收藏... ")):!R.value&&z.value.length===0?(r(),n("div",Zl," 该用户还没有收藏任何帖子哦~ ")):(r(),n("div",Xl,[(r(!0),n(O,null,Y(z.value,t=>(r(),A(ke,{key:`fav-${t.id}`,post:t,onCardClick:pe,class:"profile-post-card"},null,8,["post"]))),128)),R.value&&T.value>1?(r(),n("div",Ql," 加载更多... ")):F("",!0)]))])):F("",!0),g.value==="following"?(r(),n("div",et,[G.value&&Q.value===1?(r(),n("div",lt," 正在加载关注列表... ")):!G.value&&H.value.length===0?(r(),n("div",tt,_(L.value?"你":"TA")+"还没有关注任何人哦~ ",1)):(r(),n("div",st,[(r(!0),n(O,null,Y(H.value,t=>{var w;return r(),A(_e,{key:t.id,user:t,showFollowButton:a(f).isLoggedIn&&((w=a(f).currentUser)==null?void 0:w.id)!==t.id,isFollowing:t.isFollowing,isLoading:le.value[t.id]||!1,onToggleFollow:ye},null,8,["user","showFollowButton","isFollowing","isLoading"])}),128)),G.value&&Q.value>1?(r(),n("div",at," 加载更多... ")):F("",!0)]))])):F("",!0),g.value==="followers"?(r(),n("div",ot,[K.value&&ee.value===1?(r(),n("div",rt," 正在加载粉丝列表... ")):!K.value&&J.value.length===0?(r(),n("div",it,_(L.value?"你":"TA")+"还没有粉丝哦~ ",1)):(r(),n("div",nt,[(r(!0),n(O,null,Y(J.value,t=>{var w;return r(),A(_e,{key:t.id,user:t,showFollowButton:a(f).isLoggedIn&&((w=a(f).currentUser)==null?void 0:w.id)!==t.id,isFollowing:t.isFollowing,isLoading:le.value[t.id]||!1,onToggleFollow:ye},null,8,["user","showFollowButton","isFollowing","isLoading"])}),128)),K.value&&ee.value>1?(r(),n("div",ut," 加载更多... ")):F("",!0)]))])):F("",!0)])])):(r(),n("div",dt,"用户不存在。")),i(a(Ce),{modelValue:j.value,"onUpdate:modelValue":l[7]||(l[7]=t=>j.value=t),title:"修改头像",width:"500px",class:"avatar-dialog"},{footer:d(()=>[o("span",wt,[i(a(S),{onClick:l[6]||(l[6]=t=>j.value=!1)},{default:d(()=>l[19]||(l[19]=[V("取消")])),_:1}),i(a(S),{type:"primary",onClick:Te},{default:d(()=>l[20]||(l[20]=[V("保存")])),_:1})])]),default:d(()=>[o("div",ct,[o("div",vt,[l[13]||(l[13]=o("label",null,"预览",-1)),i(a(Z),{size:120,src:me(x.value)},null,8,["src"])]),o("div",ft,[l[16]||(l[16]=o("label",null,"上传新头像",-1)),i(a(dl),{class:"avatar-uploader-dialog",action:De.value,"show-file-list":!1,headers:Ve.value,"on-success":Ie,"before-upload":Ee,name:"avatar"},{tip:d(()=>l[15]||(l[15]=[o("div",{class:"el-upload__tip"},"只能上传 jpg/png 文件，且不超过 5MB",-1)])),default:d(()=>[i(a(S),{type:"primary"},{default:d(()=>l[14]||(l[14]=[V("点击上传")])),_:1})]),_:1},8,["action","headers"])]),o("div",gt,[l[18]||(l[18]=o("label",null,"选择预设头像",-1)),o("div",pt,[(r(!0),n(O,null,Y(X.value,t=>(r(),A(a(Z),{key:t,size:60,src:me(t),onClick:w=>x.value=t,class:W(["preset-avatar",{selected:x.value===t}])},null,8,["src","onClick","class"]))),128)),i(a(S),{text:"",onClick:l[5]||(l[5]=t=>x.value=null),class:W(["preset-avatar remove-avatar-btn",{selected:x.value===null}])},{default:d(()=>l[17]||(l[17]=[V("移除头像")])),_:1},8,["class"])])])])]),_:1},8,["modelValue"]),i(Al,{visible:ne.value,"onUpdate:visible":l[8]||(l[8]=t=>ne.value=t),"post-data":fe.value,onPostUpdated:Oe},null,8,["visible","post-data"])],64))}}),ht=ie(mt,[["__scopeId","data-v-71c5803c"]]);export{ht as default};
