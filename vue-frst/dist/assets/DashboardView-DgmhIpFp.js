import{d as H,aD as R,aE as J,aF as K,aG as P,aH as Q,aI as W,aJ as Y,aK as q,r as B,C as N,j as U,c as X,a as e,b as t,e as s,u as a,a7 as A,o as b,aa as S,aj as k,t as y,n as $,k as x,g as C,aL as E,f as h,aM as M,p as Z,ak as aa,ae as ta,y as sa,aN as ea,aO as D,aP as la,l as T,Q as oa,i as ra,_ as da}from"./index-u3ChIZEC.js";import{A as na}from"./AdminService-DpEl2DRV.js";import{E as I}from"./index-DRiRQ3Ks.js";const ia={class:"dashboard-view"},ua={class:"card-header"},ca={class:"card-content"},ha={class:"stat-value"},pa={class:"card-header"},va={class:"card-content"},fa={class:"stat-value"},_a={class:"card-header"},ga={class:"card-content"},wa={class:"stat-value"},ma={class:"card-header"},ya={class:"card-content"},ba={class:"stat-value"},xa={class:"chart-container"},Sa={class:"chart-container"},ka=H({__name:"DashboardView",setup(Da){const L=i=>{const o=new Date(i),r=o.getFullYear(),d=String(o.getMonth()+1).padStart(2,"0"),u=String(o.getDate()).padStart(2,"0"),n=String(o.getHours()).padStart(2,"0"),c=String(o.getMinutes()).padStart(2,"0");return`${r}-${d}-${u} ${n}:${c}`};R([J,K,P,Q,W,Y,q]);const V=ra(),z=B(!0),l=B(null),O=async()=>{z.value=!0;try{const i=await na.getDashboardStats();l.value=i,console.log("Dashboard stats:",l.value)}catch(i){console.error("Error fetching dashboard stats:",i)}finally{z.value=!1}},j=N(()=>{var u;const i=((u=l.value)==null?void 0:u.contentTrend)||[],o=i.map(n=>n.date),r=i.map(n=>n.showcases),d=i.map(n=>n.posts);return{tooltip:{trigger:"axis"},legend:{data:["美食图片","帖子"]},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,data:o},yAxis:{type:"value"},series:[{name:"美食图片",type:"line",data:r,smooth:!0,lineStyle:{width:3,color:"#1890ff"},itemStyle:{color:"#1890ff"}},{name:"帖子",type:"line",data:d,smooth:!0,lineStyle:{width:3,color:"#52c41a"},itemStyle:{color:"#52c41a"}}]}}),F=N(()=>{var o;const i=((o=l.value)==null?void 0:o.tagDistribution)||[];return{tooltip:{trigger:"item",formatter:"{a} <br/>{b}: {c} ({d}%)"},legend:{orient:"vertical",left:10,data:i.map(r=>r.name)},series:[{name:"标签分布",type:"pie",radius:["50%","70%"],avoidLabelOverlap:!1,label:{show:!1,position:"center"},emphasis:{label:{show:!0,fontSize:"14",fontWeight:"bold"}},labelLine:{show:!1},data:i.map(r=>({name:r.name,value:r.count}))}]}}),G=i=>{i.type==="post"?V.push(`/posts/${i.id}`):V.push(`/discover?id=${i.id}`)};return U(()=>{O()}),(i,o)=>(b(),X("div",ia,[o[8]||(o[8]=e("h2",{class:"page-title"},"仪表盘",-1)),t(a(A),{gutter:20,class:"stat-cards"},{default:s(()=>[t(a(S),{xs:24,sm:12,md:6,lg:6,xl:6},{default:s(()=>[t(a(k),{shadow:"hover",class:"stat-card"},{header:s(()=>[e("div",ua,[t(a(h),null,{default:s(()=>[t(a(Z))]),_:1}),o[0]||(o[0]=e("span",null,"美食图片",-1))])]),default:s(()=>{var r,d,u,n,c,p,v,f,_,g,w,m;return[e("div",ca,[e("div",ha,y(((d=(r=l.value)==null?void 0:r.showcases)==null?void 0:d.total)||0),1),e("div",{class:$(["stat-trend",{positive:(((n=(u=l.value)==null?void 0:u.showcases)==null?void 0:n.growth)||0)>0,negative:(((p=(c=l.value)==null?void 0:c.showcases)==null?void 0:p.growth)||0)<0}])},[(((f=(v=l.value)==null?void 0:v.showcases)==null?void 0:f.growth)||0)>0?(b(),x(a(h),{key:0},{default:s(()=>[t(a(E))]),_:1})):(((g=(_=l.value)==null?void 0:_.showcases)==null?void 0:g.growth)||0)<0?(b(),x(a(h),{key:1},{default:s(()=>[t(a(M))]),_:1})):C("",!0),e("span",null,y(Math.abs(((m=(w=l.value)==null?void 0:w.showcases)==null?void 0:m.growth)||0))+"%",1)],2)])]}),_:1})]),_:1}),t(a(S),{xs:24,sm:12,md:6,lg:6,xl:6},{default:s(()=>[t(a(k),{shadow:"hover",class:"stat-card"},{header:s(()=>[e("div",pa,[t(a(h),null,{default:s(()=>[t(a(aa))]),_:1}),o[1]||(o[1]=e("span",null,"帖子",-1))])]),default:s(()=>{var r,d,u,n,c,p,v,f,_,g,w,m;return[e("div",va,[e("div",fa,y(((d=(r=l.value)==null?void 0:r.posts)==null?void 0:d.total)||0),1),e("div",{class:$(["stat-trend",{positive:(((n=(u=l.value)==null?void 0:u.posts)==null?void 0:n.growth)||0)>0,negative:(((p=(c=l.value)==null?void 0:c.posts)==null?void 0:p.growth)||0)<0}])},[(((f=(v=l.value)==null?void 0:v.posts)==null?void 0:f.growth)||0)>0?(b(),x(a(h),{key:0},{default:s(()=>[t(a(E))]),_:1})):(((g=(_=l.value)==null?void 0:_.posts)==null?void 0:g.growth)||0)<0?(b(),x(a(h),{key:1},{default:s(()=>[t(a(M))]),_:1})):C("",!0),e("span",null,y(Math.abs(((m=(w=l.value)==null?void 0:w.posts)==null?void 0:m.growth)||0))+"%",1)],2)])]}),_:1})]),_:1}),t(a(S),{xs:24,sm:12,md:6,lg:6,xl:6},{default:s(()=>[t(a(k),{shadow:"hover",class:"stat-card"},{header:s(()=>[e("div",_a,[t(a(h),null,{default:s(()=>[t(a(ta))]),_:1}),o[2]||(o[2]=e("span",null,"用户",-1))])]),default:s(()=>{var r,d,u,n,c,p,v,f,_,g,w,m;return[e("div",ga,[e("div",wa,y(((d=(r=l.value)==null?void 0:r.users)==null?void 0:d.total)||0),1),e("div",{class:$(["stat-trend",{positive:(((n=(u=l.value)==null?void 0:u.users)==null?void 0:n.growth)||0)>0,negative:(((p=(c=l.value)==null?void 0:c.users)==null?void 0:p.growth)||0)<0}])},[(((f=(v=l.value)==null?void 0:v.users)==null?void 0:f.growth)||0)>0?(b(),x(a(h),{key:0},{default:s(()=>[t(a(E))]),_:1})):(((g=(_=l.value)==null?void 0:_.users)==null?void 0:g.growth)||0)<0?(b(),x(a(h),{key:1},{default:s(()=>[t(a(M))]),_:1})):C("",!0),e("span",null,y(Math.abs(((m=(w=l.value)==null?void 0:w.users)==null?void 0:m.growth)||0))+"%",1)],2)])]}),_:1})]),_:1}),t(a(S),{xs:24,sm:12,md:6,lg:6,xl:6},{default:s(()=>[t(a(k),{shadow:"hover",class:"stat-card"},{header:s(()=>[e("div",ma,[t(a(h),null,{default:s(()=>[t(a(sa))]),_:1}),o[3]||(o[3]=e("span",null,"收藏",-1))])]),default:s(()=>{var r,d,u,n,c,p,v,f,_,g,w,m;return[e("div",ya,[e("div",ba,y(((d=(r=l.value)==null?void 0:r.favorites)==null?void 0:d.total)||0),1),e("div",{class:$(["stat-trend",{positive:(((n=(u=l.value)==null?void 0:u.favorites)==null?void 0:n.growth)||0)>0,negative:(((p=(c=l.value)==null?void 0:c.favorites)==null?void 0:p.growth)||0)<0}])},[(((f=(v=l.value)==null?void 0:v.favorites)==null?void 0:f.growth)||0)>0?(b(),x(a(h),{key:0},{default:s(()=>[t(a(E))]),_:1})):(((g=(_=l.value)==null?void 0:_.favorites)==null?void 0:g.growth)||0)<0?(b(),x(a(h),{key:1},{default:s(()=>[t(a(M))]),_:1})):C("",!0),e("span",null,y(Math.abs(((m=(w=l.value)==null?void 0:w.favorites)==null?void 0:m.growth)||0))+"%",1)],2)])]}),_:1})]),_:1})]),_:1}),t(a(A),{gutter:20,class:"chart-row"},{default:s(()=>[t(a(S),{xs:24,sm:24,md:12,lg:12,xl:12},{default:s(()=>[t(a(k),{shadow:"hover",class:"chart-card"},{header:s(()=>o[4]||(o[4]=[e("div",{class:"card-header"},[e("span",null,"内容趋势")],-1)])),default:s(()=>[e("div",xa,[t(a(I),{class:"chart",option:j.value,autoresize:""},null,8,["option"])])]),_:1})]),_:1}),t(a(S),{xs:24,sm:24,md:12,lg:12,xl:12},{default:s(()=>[t(a(k),{shadow:"hover",class:"chart-card"},{header:s(()=>o[5]||(o[5]=[e("div",{class:"card-header"},[e("span",null,"标签分布")],-1)])),default:s(()=>[e("div",Sa,[t(a(I),{class:"chart",option:F.value,autoresize:""},null,8,["option"])])]),_:1})]),_:1})]),_:1}),t(a(A),{class:"recent-content-row"},{default:s(()=>[t(a(S),{span:24},{default:s(()=>[t(a(k),{shadow:"hover"},{header:s(()=>o[6]||(o[6]=[e("div",{class:"card-header"},[e("span",null,"最近内容")],-1)])),default:s(()=>{var r;return[t(a(ea),{data:((r=l.value)==null?void 0:r.recentContent)||[],style:{width:"100%"}},{default:s(()=>[t(a(D),{prop:"id",label:"ID",width:"80"}),t(a(D),{prop:"title",label:"标题"}),t(a(D),{prop:"type",label:"类型",width:"120"},{default:s(d=>[t(a(la),{type:d.row.type==="post"?"success":"primary"},{default:s(()=>[T(y(d.row.type==="post"?"帖子":"美食图片"),1)]),_:2},1032,["type"])]),_:1}),t(a(D),{prop:"createdAt",label:"创建时间",width:"180"},{default:s(d=>[T(y(L(d.row.createdAt)),1)]),_:1}),t(a(D),{label:"操作",width:"120"},{default:s(d=>[t(a(oa),{link:"",type:"primary",size:"small",onClick:u=>G(d.row)},{default:s(()=>o[7]||(o[7]=[T(" 查看 ")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]}),_:1})]),_:1})]),_:1})]))}}),Ma=da(ka,[["__scopeId","data-v-6a5e3d72"]]);export{Ma as default};
